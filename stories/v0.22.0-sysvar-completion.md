# Story: v0.22.0 Sysvar Completion

> 完成 Sysvar 模块，实现最后四个系统变量和工具函数

## 目标

完成所有 Sysvar 模块的实现，达到 100% 的 Sysvar 覆盖率：

1. **Last Restart Slot** - 重启插槽系统变量
2. **Sysvar** - 系统变量工具函数
3. **Sysvar ID** - 系统变量 ID 常量
4. **Epoch Rewards** - 纪元奖励系统变量

## 验收标准

### last_restart_slot.zig

- [ ] Rust 源引用注释 (last-restart-slot crate)
- [ ] `LastRestartSlot` 结构体定义
- [ ] `parse` 函数 - 从账户数据解析
- [ ] `size` 常量 (8 bytes)
- [ ] 单元测试

### sysvar.zig

- [ ] Rust 源引用注释 (sysvar crate)
- [ ] `getClock` 函数 - 获取时钟系统变量
- [ ] `getRent` 函数 - 获取租金系统变量
- [ ] `getSlotHashes` 函数 - 获取插槽哈希系统变量
- [ ] `getSlotHistory` 函数 - 获取插槽历史系统变量
- [ ] `getStakeHistory` 函数 - 获取质押历史系统变量
- [ ] `getInstructions` 函数 - 获取指令系统变量
- [ ] `checkId` 函数 - 验证系统变量账户 ID
- [ ] 单元测试

### sysvar-id.zig

- [ ] 所有系统变量的公钥常量定义
- [ ] CLOCK 常量
- [ ] RENT 常量
- [ ] SLOT_HASHES 常量
- [ ] SLOT_HISTORY 常量
- [ ] STAKE_HISTORY 常量
- [ ] INSTRUCTIONS 常量
- [ ] EPOCH_REWARDS 常量
- [ ] LAST_RESTART_SLOT 常量
- [ ] 验证常量值正确性

### epoch-rewards.zig

- [ ] Rust 源引用注释 (epoch-rewards crate)
- [ ] `EpochRewards` 结构体定义
- [ ] `parse` 函数 - 从账户数据解析
- [ ] 字段定义：distribution_starting_block_height, num_partitions, parent_blockhash, total_points, total_rewards, distributed_rewards, active
- [ ] `size` 常量 (77 bytes)
- [ ] 单元测试

### 集成

- [ ] root.zig 导出新模块
- [ ] 所有测试通过
- [ ] Sysvar 达到 100% 覆盖率 (10/10)

## 技术说明

### Last Restart Slot

Rust 源: https://github.com/anza-xyz/solana-sdk/tree/master/last-restart-slot

存储最后一次网络重启的插槽号，用于确定验证器重启后的状态恢复点。

### Sysvar

Rust 源: https://github.com/anza-xyz/solana-sdk/tree/master/sysvar

提供统一的系统变量访问接口，包含所有标准系统变量的获取函数。

### Sysvar ID

提供所有系统变量账户的固定公钥常量。这些是 Solana 网络中的标准账户地址。

### Epoch Rewards

Rust 源: https://github.com/anza-xyz/solana-sdk/tree/master/epoch-rewards

存储当前纪元奖励分配的信息，包括奖励总量、分配状态等。

## 完成状态

- 开始日期: 2026-01-05
- 完成日期: -
- 状态: ⏳ 进行中