# Story: v0.25.0 Epoch Rewards Hasher

> 实现 epoch-rewards-hasher 模块，提供确定性、无偏差的地址分区哈希功能

## 目标

- [x] 实现 `epoch_rewards_hasher.zig` - 纪元奖励分区哈希器
- [x] 使用 SipHash13 进行快速、确定性哈希
- [x] 提供无偏差的分区映射算法
- [x] 确保与 Rust 实现行为一致

## 验收标准

### epoch_rewards_hasher.zig

- [x] Rust 源引用注释 (epoch-rewards-hasher crate)
- [x] `EpochRewardsHasher` 结构体定义
- [x] `new` 函数 - 使用种子初始化哈希器
- [x] `hashAddressToPartition` 函数 - 将地址哈希到分区
- [x] `hashToPartition` 内部函数 - 无偏差分区计算
- [x] 使用 SipHash13 (Zig std.hash.SipHash64(1, 3))

### 测试 (对应 Rust 源码中的 4 个测试)

- [x] `test_get_equal_partition_range` - 分区范围计算测试
- [x] `test_hash_to_partitions` - 哈希到分区映射测试
- [x] `test_hash_to_partitions_equal_ranges` - 均匀/非均匀分区测试
- [x] `test_hasher_copy` - 哈希器状态克隆测试
- [x] 额外测试: basic functionality, different seeds

### 集成

- [x] root.zig 导出模块
- [x] 所有测试通过 (zig build test)
- [x] Hash Functions 达到 100% 覆盖率 (4/4)

## 技术说明

### Rust 源码

Rust 源: https://github.com/anza-xyz/solana-sdk/blob/master/epoch-rewards-hasher/src/lib.rs

### 核心算法

使用 SipHasher13 进行地址哈希，然后使用无偏差算法映射到分区：

```
partition = (hash * partitions) / (u64::MAX + 1)
```

使用 128 位算术避免模运算偏差。

### 依赖

- `std.hash.SipHash64(1, 3)` - Zig 标准库 SipHash-1-3
- `public_key.zig` - 地址类型
- `hash.zig` - Hash 类型 (用作种子)

## 完成状态

- 开始日期: 2026-01-05
- 完成日期: 2026-01-05
- 状态: ✅ 已完成
