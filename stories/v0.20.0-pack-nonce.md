# Story: v0.20.0 Pack/Unpack & Nonce Support

> Account data serialization traits and durable transaction nonces

## 目标

实现两个核心模块，完善账户数据处理和持久化交易能力：

1. **Program Pack** - 账户数据的 Pack/Unpack 特性
2. **Nonce** - 持久化 nonce 支持，用于离线签名等场景

## 验收标准

### program_pack.zig

- [x] Rust 源引用注释
- [x] `Pack` 接口定义 - 用于账户数据序列化/反序列化
- [x] `IsInitialized` 接口 - 检查账户是否已初始化
- [x] `packIntoSlice` - 将数据打包到字节切片
- [x] `unpackFromSlice` - 从字节切片解包数据
- [x] 与 Borsh 序列化的兼容性
- [x] 单元测试

### nonce.zig

- [x] Rust 源引用注释
- [x] `NONCE_ACCOUNT_LENGTH` 常量 (80 bytes)
- [x] `State` 枚举 - Uninitialized/Initialized
- [x] `Data` 结构体 - authority, durable_nonce, fee_calculator
- [x] `Versions` 枚举 - Current/Legacy 版本支持
- [x] 序列化/反序列化支持
- [x] 单元测试

### 集成

- [x] root.zig 导出新模块
- [x] 文档更新
- [x] 所有测试通过

## 技术说明

### Program Pack

Rust 源: https://github.com/anza-xyz/solana-sdk/tree/master/program-pack

Pack 特性提供标准化的账户数据序列化接口：
- 固定大小序列化（不同于 Borsh 的变长序列化）
- 用于 SPL Token、SPL Associated Token Account 等程序
- 提供 `LEN` 常量表示序列化后的大小

### Nonce

Rust 源: https://github.com/anza-xyz/solana-sdk/tree/master/nonce

Durable nonce 允许创建"持久化"交易：
- 交易不再依赖 recent_blockhash 的时效性
- 适用于离线签名、多签等场景
- Nonce 账户存储 durable_nonce 值替代 blockhash

## 完成状态

- 开始日期: 2026-01-05
- 完成日期: 2026-01-05
- 状态: ✅ 已完成
