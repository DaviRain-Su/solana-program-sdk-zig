# Story: v0.26.0 Feature Gate Interface

> 实现 feature-gate-interface 模块，提供运行时功能门控支持

## 目标

- [x] 实现 `feature_gate.zig` - Feature Gate 程序接口
- [x] 提供 Feature 状态类型
- [x] 提供 FeatureGateError 错误类型
- [x] 提供激活和撤销指令构建

## 验收标准

### feature_gate.zig

- [x] Rust 源引用注释 (feature-gate-interface crate)
- [x] Program ID 常量 (Feature111111111111111111111111111111111111)
- [x] `Feature` 结构体 - 包含 activated_at 字段
- [x] `Feature.SIZE` 常量 (9 bytes)
- [x] `FeatureGateError` 错误类型
- [x] `activate` 函数 - 构建激活指令
- [x] `activateWithLamports` 函数 - 带指定 lamports 激活
- [x] `revokePendingActivation` 函数 - 撤销待激活功能

### 测试

- [x] `test_feature_size_of` - Feature 大小验证 (9 bytes)
- [x] 序列化/反序列化测试
- [x] Feature default/activated 测试
- [x] Error from u32 / to string 测试
- [x] Program ID 验证测试
- [x] revokePendingActivation 指令构建测试
- [x] activateWithLamports 指令序列测试

### 集成

- [x] root.zig 导出模块
- [x] 所有测试通过 (zig build test)
- [x] Native Programs 达到 92% 覆盖率 (11/12)

## 技术说明

### Rust 源码

- lib.rs: https://github.com/anza-xyz/solana-sdk/blob/master/feature-gate-interface/src/lib.rs
- state.rs: https://github.com/anza-xyz/solana-sdk/blob/master/feature-gate-interface/src/state.rs
- instruction.rs: https://github.com/anza-xyz/solana-sdk/blob/master/feature-gate-interface/src/instruction.rs
- error.rs: https://github.com/anza-xyz/solana-sdk/blob/master/feature-gate-interface/src/error.rs

### 核心类型

```zig
/// Feature 状态
pub const Feature = struct {
    activated_at: ?u64,  // None = 待激活, Some(slot) = 已在该 slot 激活
    
    pub const SIZE: usize = 9;  // 1 byte tag + 8 bytes u64
};

/// Feature Gate 错误
pub const FeatureGateError = enum(u32) {
    FeatureAlreadyActivated = 0,
};
```

### 依赖

- `public_key.zig` - PublicKey 类型
- `instruction.zig` - AccountMeta 构建
- `system_program.zig` - System 程序指令 (transfer, allocate, assign)
- `rent.zig` - 租金计算

## 完成状态

- 开始日期: 2026-01-06
- 完成日期: 2026-01-06
- 状态: ✅ 已完成
