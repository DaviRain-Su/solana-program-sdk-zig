# Story: v0.6.0 Transaction System

> Transaction message construction and signing for Solana

## 目标

Implement the transaction system modules enabling construction and signing of Solana transactions.

## 验收标准

### message.zig (Transaction Messages)

- [x] MessageHeader struct (num_required_signatures, etc.)
- [x] CompiledInstruction struct
- [x] Message struct with account_keys, instructions
- [x] isSigner(), isWritable(), programId(), hasDuplicates()
- [x] serialize() and hash() methods
- [x] Rust source reference at file top
- [x] Unit tests (10 tests)

### transaction.zig (Transaction Types)

- [x] Transaction struct
- [x] Signature list handling
- [x] sign() and partialSign() methods
- [x] verify() and verifyAndHashMessage() methods
- [x] Serialization support
- [x] data(), key(), signerKey() accessors
- [x] Rust source reference at file top
- [x] Unit tests (8 tests)

### signer.zig (Signer Interface)

- [x] Signer vtable interface definition
- [x] pubkey(), signMessage(), isInteractive() methods
- [x] Keypair implementation of Signer
- [x] NullSigner for offline signing
- [x] uniqueSigners() utility function
- [x] SignerError enum
- [x] Rust source reference at file top
- [x] Unit tests (5 tests)

### Integration

- [x] root.zig exports (message, signer, transaction)
- [x] 测试通过 (122 tests)
- [x] ROADMAP.md 更新

## 完成状态

- 开始日期: 2026-01-03
- 完成日期: 2026-01-03
- 当前状态: ✅ 已完成

## 设计决策

### Message Format
- Support legacy message format first (v0)
- Versioned messages can be added later

### Signer Pattern
- Use Zig interface pattern (vtable or comptime)
- Keypair is the primary Signer implementation

## Rust 源码参考

| Zig 模块 | Rust crate |
|----------|-----------|
| message.zig | [message](https://github.com/anza-xyz/solana-sdk/tree/master/message) |
| transaction.zig | [transaction](https://github.com/anza-xyz/solana-sdk/tree/master/transaction) |
| signer.zig | [signer](https://github.com/anza-xyz/solana-sdk/tree/master/signer) |
